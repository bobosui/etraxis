{% extends 'admin/base.html.twig' %}

{% import "macro.html.twig" as macro %}

{% block content %}

    <div class="container">
        <div class="columns">
            <div class="column full-width">
                <button type="button" id="btn-create">{{ 'button.create'|trans }}</button>
                <button type="button" id="btn-export">{{ 'button.export'|trans }}</button>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="columns">
            <div class="column full-width">
                <table id="projects" class="cell-border hover" data-src="{{ path('admin_projects_list') }}">
                    <thead>
                        <tr>
                            <th>{{ 'project.name'|trans }}</th>
                            <th>{{ 'project.start_time'|trans }}</th>
                            <th>{{ 'description'|trans }}</th>
                        </tr>
                    </thead>
                    <thead>
                        <tr>
                            <th><input type="text"></th>
                            <th><input type="text"></th>
                            <th><input type="text"></th>
                        </tr>
                    </thead>
                </table>
            </div>
        </div>
    </div>

{% endblock %}

{% block scripts %}

    <script>

        $(function() {

            // Projects list.
            var $table = $('#projects').table();

            // Click on a project in the list.
            $table.on('click', 'tbody tr', function() {
                window.location.assign('{{ path('admin_projects') }}' + $(this).data('id'));
            });

            // "Create" button.
            $('#btn-create').click(function() {
                eTraxis.modal({
                    url: '{{ path('admin_dlg_new_project') }}',
                    title: '{{ 'project.new'|trans }}',
                    success: function() {
                        $table.api().draw(false);
                        return true;
                    }
                });
            });

            // "Export" button.
            $('#btn-export').click(function() {
                eTraxis.modal({
                    url: '{{ path('dlg_export') }}',
                    title: '{{ 'button.export'|trans }}',
                    success: function() {
                        var params = $('form').serialize() + '&' + $.param($table.api().ajax.params());
                        window.location.assign('{{ path('admin_projects_csv') }}?' + params);
                        return true;
                    }
                });
            });
        });

    </script>

{% endblock %}
