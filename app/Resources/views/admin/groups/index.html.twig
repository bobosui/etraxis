{% extends 'admin/base.html.twig' %}

{% import "macro.html.twig" as macro %}

{% block content %}

    <div class="grid-row">
        <div class="grid-100">
            <button type="button" id="btn-create">{{ 'button.create'|trans }}</button>
            <button type="button" id="btn-export">{{ 'button.export'|trans }}</button>
        </div>
    </div>

    <div class="grid-row">
        <div class="grid-100">
            <table id="groups" class="cell-border hover" data-src="{{ path('admin_groups_list') }}">
                <thead>
                    <tr>
                        <th>{{ 'group.name'|trans }}</th>
                        <th>{{ 'group.type'|trans }}</th>
                        <th>{{ 'project'|trans }}</th>
                        <th>{{ 'description'|trans }}</th>
                    </tr>
                </thead>
                <tfoot>
                    <tr>
                        <td><input type="text"></td>
                        <td>
                            <select>
                                <option value="global">{{ 'group.global'|trans }}</option>
                                <option value="local">{{ 'group.local'|trans }}</option>
                            </select>
                        </td>
                        <td>
                            <select>
                                {% for project in projects %}
                                    <option value="{{ project.id }}">{{ project.name }}</option>
                                {% endfor %}
                            </select>
                        </td>
                        <td><input type="text"></td>
                    </tr>
                </tfoot>
            </table>
        </div>
    </div>

{% endblock %}

{% block scripts %}

    <script>

        $(function() {

            // Groups list.
            var $table = $('#groups').table();

            // Click on a group in the list.
            $table.on('click', 'tbody tr', function() {
                window.location.assign('{{ path('admin_groups') }}' + $(this).data('id'));
            });

            // "Create" button.
            $('#btn-create').click(function() {
                eTraxis.modal({
                    url: '{{ path('admin_dlg_new_group') }}',
                    title: '{{ 'group.new'|trans }}',
                    success: function() {
                        $table.api().draw(false);
                        return true;
                    }
                });
            });

            // "Export" button.
            $('#btn-export').click(function() {
                eTraxis.modal({
                    url: '{{ path('dlg_export') }}',
                    title: '{{ 'button.export'|trans }}',
                    success: function() {
                        var params = $('form').serialize() + '&' + $.param($table.api().ajax.params());
                        window.location.assign('{{ path('admin_groups_csv') }}?' + params);
                        return true;
                    }
                });
            });
        });

    </script>

{% endblock %}
